# Plan to Fix "Unknown User" Issue with Comments

This document outlines the plan to resolve the issue where comments are being attributed to "Unknown User" instead of the logged-in user who created them.

## Step 1: Investigate User Creation

The first step is to investigate the user creation and authentication process to understand how user data is being handled.

-   **Examine `contexts/auth-context.tsx`**: This file contains the `useAuth` hook, which is central to user authentication. I will analyze this file to determine how new users are created and if a corresponding user document is being created in the `users` collection in Firestore.
-   **Identify User Creation Logic**: I will look for the specific function that is called when a new user signs up or logs in for the first time.

## Step 2: Identify the Missing Logic

Based on the investigation, I will pinpoint the missing piece of logic that is causing the issue.

-   **Confirm Missing User Document Creation**: I expect to find that the application is not creating a document in the `users` collection when a new user is created. This is the most likely cause of the problem.

## Step 3: Implement the Fix

Once the missing logic is identified, I will implement the necessary code to fix it.

-   **Add User Document Creation**: I will add code to create a new document in the `users` collection every time a new user is created.
-   **User Document Structure**: This new document will be stored with the user's `uid` as the document ID and will contain the user's `uid`, `email`, and `displayName`.
-   **Location of the Fix**: The new logic will likely be added to the `useAuth` hook in `contexts/auth-context.tsx`, to be executed immediately after a new user is successfully created.

## Step 4: Verify the Fix

After implementing the fix, the following steps should be taken to verify that the issue is resolved:

1.  **Create a New User**: Sign up as a new user in the application.
2.  **Check `users` Collection**: In the Firebase console, verify that a new document has been created in the `users` collection with the new user's information.
3.  **Add a Comment**: Log in as the new user and add a comment to a card.
4.  **Verify Comment Display**: Confirm that the newly added comment is now displayed with the correct user name, and not "Unknown User".
