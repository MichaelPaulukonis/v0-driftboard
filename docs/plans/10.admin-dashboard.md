# Product Requirements Document: Admin Reports/Stats Dashboard

## 1. Problem Statement & Vision

- **Problem:** Need a lightweight, reliable view of active usage, system health, and trend signals for a very small user base (currently 2 users), with the possibility (however unlikely) of sudden growth due to public sign-up.
- **Audience:** Sole admin, with potential future extension to moderators; access should remain restricted to trusted roles.
- **Vision:** A standalone, read-only admin dashboard that first attempts a COTS approach (Metabase) to deliver KPIs quickly. It should fetch fresh data on demand (manual refresh), run locally via Docker (Vercel later if/when needed), and keep operational overhead low. If Metabase proves unsuitable, fall back to a lightweight custom Remix/React build.

## 2. Target Users & Use Cases

- **Primary Target Users:**
  - **Solo Admin:** The sole administrator (you) managing and monitoring the Driftboard application.
- **Key User Journeys:**
  1. **View Aggregate KPIs:** From the dashboard overview, view total counts across all users (boards, lists, cards, comments, users).
  2. **Track Changes Over Time:** Observe trends and changes in usage patterns across different time periods.
  3. **Drill Down into Entities:**
     - Overview → Users → specific user → recent activity
     - Overview → Shared Boards → participating users
  - **No Export or Real-time Updates:** MVP focuses on visibility with manual refresh; no CSV exports or live data streaming needed.
- **Future Use Cases:** Authentication for cloud deployment, additional admin roles, alerting on anomalies.

## 3. Core Features & Requirements

- **Must-Have Features (MVP):**
  - **Metabase-First Implementation:** Spin up Metabase via Docker, connect to Firestore using the Metabase Firebase/Firestore connector, and build the KPIs.
  - **Core Metrics Display:**
    - User count (total, active)
    - Board count (total, per user, shared boards)
    - List count
    - Card count
    - Comment count
  - **Drill-Down Navigation:** Click-through from aggregate stats to individual entities (users, boards) using Metabase dashboards/questions.
  - **Manual Refresh:** On-demand data fetching (Metabase refresh or question reload) triggered by user action.
  - **Docker Deployment:** Containerized for local deployment with minimal configuration.
  - **Fallback Plan:** If Metabase cannot satisfy MVP (connector limits, auth constraints), build a lightweight custom Remix/React dashboard with a thin Express API layer to keep Firebase credentials server-side.

- **Nice-to-Have Features (Day 2):**
  - **Time-Range Filters:** Filter metrics by hour/day/week/month.
  - **Activity Timeline:** Visual timeline of recent changes/activity.
  - **Database Health Metrics:** Storage size, query performance indicators.
  - **Authentication UI:** Login screen for cloud deployment.
  - **Auto-Refresh:** Configurable intervals for data refresh.
  - **Charts & Visualizations:** Growth trends, activity heatmaps.
  - **Vercel Deployment:** Cloud hosting with proper authentication.

## 4. Success Metrics & Goals

- **Success Criteria:**
  1. **Functional Implementation:** KPIs are visible and drillable in a single dashboard view.
  2. **Quick Deployment:** Docker container can be launched and stats viewed immediately (quick-n-dirty implementation for visibility).
  3. **Accuracy:** Stats should be spot-checked against Firestore console for correctness.
- **Primary Goal:**
  - To provide immediate visibility into system health and usage patterns for operational awareness.
  - To establish a foundation for future monitoring and analytics capabilities as the user base grows.
- **Monitoring:** Purely informational; no alerting or anomaly detection needed for MVP.

## 5. Technical Considerations

- **Platform & Stack:**
  - **Primary (COTS-first):** Metabase in Docker connecting to Firebase/Firestore via the Metabase Firestore connector.
  - **Fallback (Custom):** Remix + React for UI, with a lightweight Express.js API layer (or Remix server actions) for Firebase queries.
  - **Database:** Firebase/Firestore (read-only access for admin stats).
  - **Deployment:** Docker for local hosting; future migration to Vercel for cloud hosting.
- **Authentication & Security:**
  - **MVP (Metabase):** Protect Metabase with an admin token or password set via environment variables; restrict network exposure to local only.
  - **MVP (Custom Fallback):** Token-based auth via Docker environment variables (no login UI), credentials kept server-side.
  - **Future:** Proper authentication flow when deploying to cloud (Firebase Auth integration).
  - **Security:** Read-only Firebase credentials; server-side access only (Metabase connector or Express API) to avoid exposing credentials to the browser.
- **Performance & Scalability:**
  - **MVP:** "Fetch on demand" with manual refresh is sufficient.
  - **Future:** Implement caching, query optimization, and auto-refresh as user base grows.
- **Integration Needs:**
  - **Metabase-first:** Use Metabase Firestore connector for direct read-only access.
  - **Fallback:** Direct Firebase/Firestore integration via a server API.
  - Third-party BI limited to Metabase for MVP; avoid additional tools to keep complexity minimal.
- **Constraints:**
  - Must be a standalone application (separate from main Driftboard codebase).
  - Should prefer Metabase-first for speed; retain option to pivot to custom Remix/React if COTS is insufficient.
  - Must support future monorepo architecture and frontend/backend separation.
  - Must be deployable locally via Docker without complex configuration.
